{
	"name": "setup",
	"properties": {
		"content": {
			"query": "\n-- https://docs.microsoft.com/en-us/sql/t-sql/statements/create-external-data-source-transact-sql?view=azure-sqldw-latest\n-- https://docs.microsoft.com/en-us/sql/t-sql/statements/create-external-table-as-select-transact-sql?view=azure-sqldw-latest\n\n\n\n\nCREATE EXTERNAL FILE FORMAT TextFileFormat_CSAtraining\nWITH \n(   \n    FORMAT_TYPE = DELIMITEDTEXT,\n    FORMAT_OPTIONS\n    (   \n        FIELD_TERMINATOR = '|'\n    )\n)\nGO\n\nCREATE EXTERNAL FILE FORMAT [Parquet] WITH (FORMAT_TYPE = PARQUET);\n\n\nCREATE EXTERNAL FILE FORMAT [compressed_TextFileFormat] WITH \n(FORMAT_TYPE = DELIMITEDTEXT, FORMAT_OPTIONS (FIELD_TERMINATOR = N'|', \nUSE_TYPE_DEFAULT = False), DATA_COMPRESSION = N'org.apache.hadoop.io.compress.GzipCodec')\nGO\n\n\nCREATE SCHEMA staging;\nGO\n\n\nCREATE EXTERNAL TABLE [staging].[FactInternetSales_text]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[RevisionNumber] [tinyint] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [float] NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmt] [money] NOT NULL,\n\t[Freight] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL\n)\nWITH (\nDATA_SOURCE = [enterprise_adls],\nLOCATION = N'/loading/FactInternetSales/text',\nFILE_FORMAT = [TextFileFormat_CSAtraining],\nREJECT_TYPE = VALUE,\nREJECT_VALUE = 0)\n\n\nCREATE EXTERNAL TABLE [staging].[FactInternetSales_parquet]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[RevisionNumber] [tinyint] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [float] NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmt] [money] NOT NULL,\n\t[Freight] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL\n)\nWITH (\nDATA_SOURCE = [enterprise_adls],\nLOCATION = N'/loading/FactInternetSales/parquet',\nFILE_FORMAT = [parquet],\nREJECT_TYPE = VALUE,\nREJECT_VALUE = 0)\n\n\n--DROP  EXTERNAL TABLE [staging].[FactInternetSales_compressed_text]\nCREATE EXTERNAL TABLE [staging].[FactInternetSales_compressed_text]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[RevisionNumber] [tinyint] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [float] NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmt] [money] NOT NULL,\n\t[Freight] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL\n)\nWITH (\nDATA_SOURCE = [enterprise_adls],\nLOCATION = N'/loading/FactInternetSales/text_compressed',\nFILE_FORMAT = compressed_TextFileFormat,\nREJECT_TYPE = VALUE,\nREJECT_VALUE = 0)\n\n\n\n\n--DROP  EXTERNAL TABLE [staging].[FactInternetSales_compressed_text]\nCREATE EXTERNAL TABLE  [staging].[FactInternetSales_single_compressed_text]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[RevisionNumber] [tinyint] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [float] NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmt] [money] NOT NULL,\n\t[Freight] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL\n)\nWITH (\nDATA_SOURCE = [enterprise_adls],\nLOCATION = N'/loading/FactInternetSales/singe_text_compressed',\nFILE_FORMAT = compressed_TextFileFormat,\nREJECT_TYPE = VALUE,\nREJECT_VALUE = 0)\n\n\nCREATE EXTERNAL TABLE [staging].[FactInternetSales_single_text]\n(\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[RevisionNumber] [tinyint] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [float] NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmt] [money] NOT NULL,\n\t[Freight] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL\n)\nWITH (\nDATA_SOURCE = [enterprise_adls],\nLOCATION = N'/loading/FactInternetSales/text_single_file',\nFILE_FORMAT = [TextFileFormat_CSAtraining],\nREJECT_TYPE = VALUE,\nREJECT_VALUE = 0)\n\n\n-- 20 seconds\nselect count_big(*) from [staging].[FactInternetSales_text]\n\n-- 8 seconds\nselect count_big(*) from [staging].[FactInternetSales_parquet]\n\n-- 8 seconds\nselect count_big(*) from [staging].[FactInternetSales_compressed_text]\n\nselect count_big(*) from [staging].[FactInternetSales_single_compressed_text];\n\nselect count_big(*) from [staging].[FactInternetSales_single_text]\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "mpmsqlpool",
				"type": "SqlCompute"
			}
		},
		"type": "SqlQuery"
	}
}